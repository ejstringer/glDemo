---
title: "dartR data and data input"
author: "Arthur Georges and Emily Stringer"
output:
  learnr::tutorial:
    progressive: false
    theme: "united"
    highlight: "kate"
    css: 
    - ./css/discovr_style_future2.css
    - ./css/custom_call.css
runtime: shiny_prerendered
description: "data in dartR"
---

<html lang="en">

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)

#necessary to render tutorial correctly
library(learnr) 
library(htmltools)

library(dartR.data)
library(dartR.base)

library(glDemo)

```


## Worked Example

In this worked example, we will access the sample data files provided on the `dartR` web page

-   **sample_data_2Row.csv**

-   **sample_data_silicodart.csv**

-   **sample_metadata.csv**

### Assign a working directory, download raw data

A first step is to assign a working directory

::: {.my-solution icon="false"}

:::: {style="display: flex;"}

::: {.column width="20%"}

<br> ![](./images/task.png){#id .class width="100" height="100"}

:::

::: {.column width="80%"}

Create a project using the RStudio menu (File - New Project) and set the default directory for files using The RStudio menu (Session - Set Working Directory). Alternatively use [set.wd()]{style="color:blue;"}.

Also set the global verbosity level to 3 to provided detailed diagnostics, [gl.set.verbosity(3)]{style="color:blue;"}
:::

::::

:::



## Data 

### Download raw data

::: {.infobox icon="false"}
::: columns
::: {.column width="20%"}
<br> ![](./images/task.png){#id .class width="100" height="100"}
:::

::: {.column width="80%"}
Download the two datafiles using the links provided above and place them in the working directory. Open the file [sample_data_2Row.csv]{style="color:#007bff;"} in Excel. This is a set of SNP data for Emydura, a freshwater turtle, in 2-row format as would be supplied by Diversity Arrays Technology Pty Ltd.
:::
:::
:::

The contents and format of the csv file do not need to concern you. dartR handles all the complexities. If you do want to learn more, refer to the MetaDataDefinition file provided by Diversity Arrays Technology as part of their report. In this case, a definition file is provided as [sample_metadata.xlsx]{style="color:#cc9900; font-family: 'Courier New';"}. You can also go the the [Diversity Arrays Technology ([DArT]{style="color:#cc9900;"})](https://www.diversityarrays.com/) website.

### Download the individual metadata file

Recall that the individual metadata comprise attributes assigned to each individual.

::: {.infobox icon="false"}
::: columns
::: {.column width="20%"}
<br> ![](./images/task.png){#id .class width="100" height="100"}
:::

::: {.column width="80%"}
<br> Download the individual metadata file datafile [sample_metadata.csv]{style="color:#007bff;"} using the link provided above and place it in the working directory.

Open the file in Excel and examine its contents.
:::
:::
:::

The individual metadata file [sample_metadata.csv]{style="color:blue; font-family: 'Courier New';"} has two compulsory fields **id** and **pop**, and some optional fields **lat**, **long**, **sex** and **maturity** associated with each individual. You can add whatever attributes you like to this metadata file.

### Read the data into dartR

::: {.infobox icon="false"}
::: columns
::: {.column width="10%"}
<br> ![](./images/task.png){#id .class width="48" height="48"}
:::

::: {.column width="90%"}
Read the data from [sample_data_2Row.csv]{style="color:blue;"} into a dartR object and assign the individual metrics:
:::
:::
:::

```{r}
gl <- gl.read.dart(filename="./www/sample_data_2Row.csv",
  ind.metafile="./www/samplemetadata1.csv")
```

## Explore

### Interrogate the dartR genlight object

Let's examine the contents of the dartR object.

::: {.infobox icon="false"}
::: columns
::: {.column width="20%"}
<br> ![](./images/task.png){#id .class width="100" height="100"}
:::

::: {.column width="80%"}
Undertake some basic diagnostics using:

```{r eval = FALSE}
nInd(gl)
nLoc(gl)
nPop(gl) 

```

```{r diag-setup}
gl <- gl_sample 

```

```{r diag, exercise=TRUE}

```

```{r diag-solution}
nInd(gl)
nLoc(gl)
nPop(gl)

```


:::
:::
:::

Maybe check the population and individual names:

```{r}
popNames(gl)
indNames(gl)

```

What do we have in the way of individual metrics:

```{r}
names(gl@other$ind.metrics)
```

## More explore

::: {.infobox icon="false"}
::: columns
::: {.column width="20%"}
<br> ![](./images/task.png){#id .class width="100" height="100"}
:::

::: {.column width="80%"}
Undertake some basic diagnostics using: Examine the contents of the individual metrics, in this case the first 10 values of the attribute "sex":

```{r eval = FALSE}
# Only first 10 entries shown
gl@other$ind.metrics$sex[1:10]

```

Try it also with some other metrics.

```{r met_data, exercise=TRUE}

```

```{r met_data-solution}
# example
gl@other$ind.metrics$pop[1:10]
```
:::

:::

:::
